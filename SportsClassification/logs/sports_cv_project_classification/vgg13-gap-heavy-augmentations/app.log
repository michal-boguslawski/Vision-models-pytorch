2025-09-13 18:47:06,368 | INFO | S3 bucket computer-vision-models-pytorch-bucket exists.
2025-09-13 18:47:06,484 | INFO | DynamoDB table computer-vision-models-config-table exists.
2025-09-13 18:47:06,488 | INFO | Config: project_name: sports_cv_project_classification
experiment_name: vgg13-gap-heavy-augmentations
model:
  backbone_name: VGG13
  detection_head_name: GAP
  pretrained:
    model_part: backbone
    experiment_name: vgg11-gap-heavy-augmentations
    save_locally: true
    freeze_time: 10
  num_classes: 100
  num_anchors: 3
  dropout_rate: 0.5
  hidden_dim: 4096
dataset:
  name: sports_images
  source: kaggle
  kaggle_dataset_name: gpiosenka/sports-classification
  force_download: false
  root_dir: data
  raw_subdir: raw
  processed_subdir: processed
  annotations_subdir: annotations
  annotations_file: sports.csv
  use_existing_train_test_split: true
  train_subdir: train
  val_subdir: val
  test_subdir: test
  input_size:
  - 224
  - 224
  normalize_mean:
  - 0.4714
  - 0.4699
  - 0.4551
  normalize_std:
  - 0.2391
  - 0.2302
  - 0.232
  augmentations:
    horizontal_flip: true
    rotation: true
    random_crop: false
    color_jitter: true
    random_resized_crop: true
    grayscale: true
    gaussian_blur: true
    perspective: true
    affine: true
    erasing: true
    adjust_sharpness: true
  batch_size: 64
  shuffle: true
  num_workers: 16
  seed: 42
checkpoints_dir: checkpoints/
logs_dir: logs/
training:
  optimizer:
    type: adam
    lr: 0.0005
    weight_decay: 0.0005
  scheduler:
    type: one_cycle_lr
    total_steps: 300
    pct_start: 0.25
    max_lr: 0.001
  loss:
    type: cross_entropy
    bbox_loss: smooth_l1
    obj_loss: binary_cross_entropy
  early_stopping:
    patience: 0
    threshold: 0.0001
  num_epochs: 1000
  save_best_only: true
  save_checkpoint: true
  log_interval: 50
evaluation:
  metrics:
  - accuracy
  - top-5-accuracy
  iou_threshold: 0.5
  conf_threshold: 0.3
misc:
  device: cuda
  seed: 42
  deterministic: true
s3_bucket: computer-vision-models-pytorch-bucket
dynamodb_config_table: computer-vision-models-config-table

2025-09-13 18:47:06,490 | INFO | Global seed set to 42
2025-09-13 18:47:06,525 | INFO | Added item to DynamoDB table: dynamodb.Table(name='computer-vision-models-config-table')
2025-09-13 18:47:06,974 | INFO | [Local] Loaded model weights from checkpoints/sports_cv_project_classification/vgg11-gap-heavy-augmentations/best_model.pth
2025-09-13 18:47:06,975 | INFO | Loaded weights were frozen
2025-09-13 18:47:06,976 | INFO | Training started...
2025-09-13 18:47:06,976 | INFO | BuildModel(
  (backbone): VGG(
    (features): Sequential(
      (block0conv0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (block0activation0): ReLU(inplace=True)
      (block0conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (block0activation1): ReLU(inplace=True)
      (block0pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      (block1conv0): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (block1activation0): ReLU(inplace=True)
      (block1conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (block1activation1): ReLU(inplace=True)
      (block1pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      (block2conv0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (block2activation0): ReLU(inplace=True)
      (block2conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (block2activation1): ReLU(inplace=True)
      (block2pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      (block3conv0): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (block3activation0): ReLU(inplace=True)
      (block3conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (block3activation1): ReLU(inplace=True)
      (block3pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
      (block4conv0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (block4activation0): ReLU(inplace=True)
      (block4conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (block4activation1): ReLU(inplace=True)
      (block4pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    )
  )
  (detecton_head): GAPDoubleLinearHead(
    (classifier): Sequential(
      (0): AvgPool2d(kernel_size=(7, 7), stride=(7, 7), padding=0)
      (1): Flatten(start_dim=1, end_dim=-1)
      (2): Linear(in_features=512, out_features=4096, bias=True)
      (3): ReLU(inplace=True)
      (4): Dropout(p=0.5, inplace=False)
      (5): Linear(in_features=4096, out_features=4096, bias=True)
      (6): ReLU(inplace=True)
      (7): Dropout(p=0.5, inplace=False)
      (8): Linear(in_features=4096, out_features=100, bias=True)
    )
  )
)
2025-09-13 18:47:47,088 | INFO | Epoch summary loss: 4.517649 accuracy: 0.022102 top-5-accuracy: 0.103405
2025-09-13 18:47:48,763 | INFO | Current lr: 4.0432496221752784e-05
2025-09-13 18:47:48,763 | INFO | Last best score 4.167919158935547 - 0 steps ago
2025-09-13 18:47:48,763 | INFO | {'epoch_accuracy': 0.04800000041723251, 'epoch_top-5-accuracy': 0.20600000023841858, 'epoch_loss': 4.167919158935547, 'epoch': 0, 'dataset': 'val'}
2025-09-13 18:47:48,843 | INFO | [Local] Saved model weights to checkpoints/sports_cv_project_classification/vgg13-gap-heavy-augmentations/best_model.pth
2025-09-13 18:47:48,843 | INFO | Best model saved
2025-09-13 18:48:27,732 | INFO | Epoch summary loss: 4.189080 accuracy: 0.053927 top-5-accuracy: 0.197332
2025-09-13 18:48:29,402 | INFO | Current lr: 4.17292054995873e-05
2025-09-13 18:48:29,402 | INFO | Last best score 3.8374215960502625 - 0 steps ago
2025-09-13 18:48:29,402 | INFO | {'epoch_accuracy': 0.10599999874830246, 'epoch_top-5-accuracy': 0.2759999930858612, 'epoch_loss': 3.8374215960502625, 'epoch': 1, 'dataset': 'val'}
2025-09-13 18:48:29,501 | INFO | [Local] Saved model weights to checkpoints/sports_cv_project_classification/vgg13-gap-heavy-augmentations/best_model.pth
2025-09-13 18:48:29,501 | INFO | Best model saved
2025-09-13 18:49:08,226 | INFO | Epoch summary loss: 4.041128 accuracy: 0.071899 top-5-accuracy: 0.239730
2025-09-13 18:49:09,911 | INFO | Current lr: 4.3887791075739144e-05
2025-09-13 18:49:09,911 | INFO | Last best score 3.6819890439510345 - 0 steps ago
2025-09-13 18:49:09,911 | INFO | {'epoch_accuracy': 0.11599999666213989, 'epoch_top-5-accuracy': 0.3319999873638153, 'epoch_loss': 3.6819890439510345, 'epoch': 2, 'dataset': 'val'}
2025-09-13 18:49:10,010 | INFO | [Local] Saved model weights to checkpoints/sports_cv_project_classification/vgg13-gap-heavy-augmentations/best_model.pth
2025-09-13 18:49:10,011 | INFO | Best model saved
2025-09-13 18:49:48,706 | INFO | Epoch summary loss: 3.944815 accuracy: 0.080045 top-5-accuracy: 0.268137
2025-09-13 18:49:50,396 | INFO | Current lr: 4.690436303309996e-05
2025-09-13 18:49:50,396 | INFO | Last best score 3.588941752910614 - 0 steps ago
2025-09-13 18:49:50,396 | INFO | {'epoch_accuracy': 0.12600000202655792, 'epoch_top-5-accuracy': 0.38199999928474426, 'epoch_loss': 3.588941752910614, 'epoch': 3, 'dataset': 'val'}
2025-09-13 18:49:50,494 | INFO | [Local] Saved model weights to checkpoints/sports_cv_project_classification/vgg13-gap-heavy-augmentations/best_model.pth
2025-09-13 18:49:50,494 | INFO | Best model saved
2025-09-13 18:50:29,262 | INFO | Epoch summary loss: 3.856711 accuracy: 0.095926 top-5-accuracy: 0.303073
2025-09-13 18:50:30,933 | INFO | Current lr: 5.07734853051106e-05
2025-09-13 18:50:30,933 | INFO | Last best score 3.4833420515060425 - 0 steps ago
2025-09-13 18:50:30,933 | INFO | {'epoch_accuracy': 0.17000000178813934, 'epoch_top-5-accuracy': 0.37599998712539673, 'epoch_loss': 3.4833420515060425, 'epoch': 4, 'dataset': 'val'}
2025-09-13 18:50:31,035 | INFO | [Local] Saved model weights to checkpoints/sports_cv_project_classification/vgg13-gap-heavy-augmentations/best_model.pth
2025-09-13 18:50:31,035 | INFO | Best model saved
2025-09-13 18:51:09,780 | INFO | Epoch summary loss: 3.769582 accuracy: 0.107769 top-5-accuracy: 0.327544
2025-09-13 18:51:11,405 | INFO | Current lr: 5.5488185471920504e-05
2025-09-13 18:51:11,405 | INFO | Last best score 3.3438195288181305 - 0 steps ago
2025-09-13 18:51:11,405 | INFO | {'epoch_accuracy': 0.17000000178813934, 'epoch_top-5-accuracy': 0.4560000002384186, 'epoch_loss': 3.3438195288181305, 'epoch': 5, 'dataset': 'val'}
2025-09-13 18:51:11,506 | INFO | [Local] Saved model weights to checkpoints/sports_cv_project_classification/vgg13-gap-heavy-augmentations/best_model.pth
2025-09-13 18:51:11,506 | INFO | Best model saved
2025-09-13 18:51:50,306 | INFO | Epoch summary loss: 3.692786 accuracy: 0.126789 top-5-accuracy: 0.355929
2025-09-13 18:51:52,020 | INFO | Current lr: 6.103996732515957e-05
2025-09-13 18:51:52,021 | INFO | Last best score 3.2121141850948334 - 0 steps ago
2025-09-13 18:51:52,021 | INFO | {'epoch_accuracy': 0.20600000023841858, 'epoch_top-5-accuracy': 0.492000013589859, 'epoch_loss': 3.2121141850948334, 'epoch': 6, 'dataset': 'val'}
2025-09-13 18:51:52,123 | INFO | [Local] Saved model weights to checkpoints/sports_cv_project_classification/vgg13-gap-heavy-augmentations/best_model.pth
2025-09-13 18:51:52,123 | INFO | Best model saved
2025-09-13 18:52:30,795 | INFO | Epoch summary loss: 3.616169 accuracy: 0.135675 top-5-accuracy: 0.382644
2025-09-13 18:52:32,428 | INFO | Current lr: 6.741882617867958e-05
2025-09-13 18:52:32,428 | INFO | Last best score 3.0718707144260406 - 0 steps ago
2025-09-13 18:52:32,428 | INFO | {'epoch_accuracy': 0.2280000001192093, 'epoch_top-5-accuracy': 0.5220000147819519, 'epoch_loss': 3.0718707144260406, 'epoch': 7, 'dataset': 'val'}
2025-09-13 18:52:32,531 | INFO | [Local] Saved model weights to checkpoints/sports_cv_project_classification/vgg13-gap-heavy-augmentations/best_model.pth
2025-09-13 18:52:32,531 | INFO | Best model saved
2025-09-13 18:53:11,188 | INFO | Epoch summary loss: 3.499881 accuracy: 0.150759 top-5-accuracy: 0.411616
2025-09-13 18:53:12,798 | INFO | Current lr: 7.461326689767547e-05
2025-09-13 18:53:12,798 | INFO | Last best score 3.000949114561081 - 0 steps ago
2025-09-13 18:53:12,798 | INFO | {'epoch_accuracy': 0.21400000154972076, 'epoch_top-5-accuracy': 0.5559999942779541, 'epoch_loss': 3.000949114561081, 'epoch': 8, 'dataset': 'val'}
2025-09-13 18:53:12,909 | INFO | [Local] Saved model weights to checkpoints/sports_cv_project_classification/vgg13-gap-heavy-augmentations/best_model.pth
2025-09-13 18:53:12,909 | INFO | Best model saved
2025-09-13 18:53:51,443 | INFO | Epoch summary loss: 3.414259 accuracy: 0.167757 top-5-accuracy: 0.443185
2025-09-13 18:53:53,065 | INFO | Current lr: 8.261032461369486e-05
2025-09-13 18:53:53,066 | INFO | Last best score 2.852462351322174 - 0 steps ago
2025-09-13 18:53:53,066 | INFO | {'epoch_accuracy': 0.24400000274181366, 'epoch_top-5-accuracy': 0.6159999966621399, 'epoch_loss': 2.852462351322174, 'epoch': 9, 'dataset': 'val'}
2025-09-13 18:53:53,162 | INFO | [Local] Saved model weights to checkpoints/sports_cv_project_classification/vgg13-gap-heavy-augmentations/best_model.pth
2025-09-13 18:53:53,163 | INFO | Best model saved
2025-09-13 18:53:53,163 | INFO | Loaded weights were unfrozen
